\subsection{Software}
MATLAB

MZmine 2.31, an open source data processing software for \acrshort{lc-ms} and \acrshort{gc-ms}. 

MassLynx

DataBridge, an \acrshort{lc-ms} data file conversion program built-in MassLynx developed by Waters.


\subsection{Data-preprocessing}
Data-preprocessing consists x steps.

% Data convertion
First, data format was converted by DataBridge from '.raw' to '.cdf'. '.raw' was the format directly generated by Waters analytical platform. In order to be readable by MZmine, data was converted\footnote{N.B. Although in MZmine manual, '.raw' file is described as a compatible format, in practice some weird errors were generated when '.raw' format was input into MZmine.}.

% MZmine step
Then, the data was preprocessed by MZmine (2.31) following the steps: peak detection, deisotoping, alignment and gap filling.

Positive mode and negative were separately processed because of different noise level and in-source reaction. Blank samples were also excluded in pre-processing.

% result
In the end, the detected features, including information of mass to charge ratio (m/z), retention time (rt) and intensities were output as '.csv' files for further investigation.

\subsection{Data conversion from MATLAB to R}
'm2r.R'\footnote{codes were reposited on GitHub: https://github.com/tuhulab/bfi-wholegrain/blob/master/r/m2r.R} can convert a matlab dataset into R tidy form.