##extract person
person1 <- matdata1$label[[21]]
person <- person1[[1]]
##extract intensities
int <- matdata1$data
##shape new data
data <- data.frame(filename,meal,protein_source,timepoint,person)
#  pools <- data %>% filter(samplename =='pool  ')
#  nonpools <- data %>% filter(samplename != 'pool  ')
#  pools$subject <- 'pool'
#  pools$timepoint <- NA
#  pools$intervention <- 'pool'
#  data <- bind_rows(nonpools,pools)
intdata <- data.frame(int)
datan <- bind_cols(data,intdata)
datan1 <- datan %>% gather(feature,intensity,6:ncol(datan))
##write rt and mz
rtdata <- t(rt) %>% data.frame() %>% gather(feature, rt, 1: nrow(rt))
mzdata <- t(mz) %>% data.frame() %>% gather(feature, mz, 1: nrow(mz))
datan2 <- left_join(datan1,rtdata,by='feature') %>% left_join(mzdata,by='feature')
datan3 <- datan2 %>% filter(meal==c('Barley','Pie   ','Soup  '))
features <- paste0('X',1:19)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)
}
lapply(features, excretionplot)
datan3 %>% filter (feature='X3')
datan3 %>% filter (feature=='X3')
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint==c(1,2,3,4)) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)
}
lapply(features, excretionplot)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint==c(1,2,3,4)) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)
}
lapply(features, excretionplot)
summarize(datan3)
View(datan3)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24 %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)
}
lapply(features, excretionplot)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24 %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)
}
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24 %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex) }
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24 %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex) }
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24 %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)}
lapply(features, excretionplot)
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity)) %>%
mutate(intmean) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex)}
lapply(features, excretionplot)
sd(c(1,2))
?geom_errorbar
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
ggtitle(featurex)}
lapply(features, 'X1')
excretionplot('X1')
lapply(features, c('X1','X2')
lapply(features, c('X1','X2'))
lapply(features, c('X1','X2'))
lapply(c('X1','X2'),excretionplot)
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
ggtitle(featurex)}
lapply(c('X1','X2'),excretionplot)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line()
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24)
View(datatrail)
View(datan3)
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line()
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle(featurex) + + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') + + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') +
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1')
datatrail <- datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1')
View(datatrail)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1')
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') + geom_errorbar(ymin=intmean-intsd,ymax=intmean+intsd)
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1')
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X2' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() +
ggtitle('X1') + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
ggtitle(featurex)}
lapply(features,excretionplot)
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
ggtitle(featurex)}
features <- paste0('X',1:19)
lapply(features,excretionplot)
excretionplot <- function (featurex)
{datan3 %>% group_by(feature,timepoint,meal) %>% summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_point() + geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
ggtitle(featurex)}
excretionplot('X1')
excretionplot('X1')
excretionplot('X2')
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) + geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd))
ggtitle(featurex)
}
excretionplot('X2')
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
ggtitle(featurex)
}
lapply(features,excretionplot)
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
lapply(features,excretionplot)
datasummary <- datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd)
datasummary
View(datan)
View(datan3)
View(datasummary)
excretionplotofprotein <- function (featurex){
datan3 %>% group_by(feature,timepoint,protein_source) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=protein_source,color=protein_source)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
excretionplotofprotein('X1')
excretionplotofprotein('X2')
excretionplotofprotein('X3')
excretionplotofprotein('X4')
datan3 %>% group_by(feature,timepoint,person) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=person,color=person)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
datan3 %>% group_by(feature,timepoint,person) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature=='X1' & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=person,color=person)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle('X1')
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() + geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
excretionplot('X1')
excretionplot('X2')
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
#geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
excretionplot('X2')
excretionplot('X3')
excretionplot('X4')
excretionplot('X5')
excretionplot('X6')
excretionplot('X7')
lapply(features,excretionplot)
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
lapply(features,excretionplot)
library(R.matlab)
library(tidyverse)
path <- 'C:\\Users\\tuhu\\projects\\barley\\datamatchNEG.mat'
matdata <- readMat(path)
matdata1 <- matdata[[1]] #[1] and [[1]] are different
#subject info
##extract filename
filename1 <- matdata1$label[[1]]
filename <- filename1[[1]]
##extract samplename
meal1 <- matdata1$label[[5]]
meal <- meal1[[1]]
##extract protein source
protein_source1 <- matdata1$label[[9]]
protein_source <- protein_source1[[1]]
##extract gender info
gender1 <- matdata1$label[[13]]
gender <- gender1[[1]]
##extract time point
timepoint1 <- matdata1$class[[1]]
timepoint <- t(timepoint1[[1]])
##extract mz
mz1 <- matdata1$label[[2]]
mz <- mz1[[1]]
##extract rt
rt1 <- matdata1$label[[10]]
rt <- rt1[[1]]
##extract person
person1 <- matdata1$label[[21]]
person <- person1[[1]]
##extract intensities
int <- matdata1$data
##shape new data
data <- data.frame(filename,meal,protein_source,timepoint,person)
#  pools <- data %>% filter(samplename =='pool  ')
#  nonpools <- data %>% filter(samplename != 'pool  ')
#  pools$subject <- 'pool'
#  pools$timepoint <- NA
#  pools$intervention <- 'pool'
#  data <- bind_rows(nonpools,pools)
intdata <- data.frame(int)
datan <- bind_cols(data,intdata)
datan1 <- datan %>% gather(feature,intensity,6:ncol(datan))
##write rt and mz
rtdata <- t(rt) %>% data.frame() %>% gather(feature, rt, 1: nrow(rt))
mzdata <- t(mz) %>% data.frame() %>% gather(feature, mz, 1: nrow(mz))
datan2 <- left_join(datan1,rtdata,by='feature') %>% left_join(mzdata,by='feature')
datan3 <- datan2 %>% filter(meal==c('Barley','Pie   ','Soup  '))
View(datan3)
features <- paste0('X',1:39)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
lapply(features,excretionplot)
datan3 %>% group_by(feature,timepoint,protein_source) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=protein_source,color=protein_source)) +
geom_line() +
#geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
excretionplotofprotein <- function (featurex){
datan3 %>% group_by(feature,timepoint,protein_source) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=protein_source,color=protein_source)) +
geom_line() +
#geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
View(datan3)
View(mz)
matdata1
matdata$axisscale
summary(matdata)
matdata$label[1]
matdata$label[[1}]
matdata$label[[1]
]
matdata$label[[1]]
matdata$label[[1]]
matdata1$label[[1]]
matdata1$label[[5]]
matdata1$label[[9]]
matdata1$label[[13]]
matdata1$label[[2]]
matdata1$label[[3]]
matdata1$label[[4]]
matdata1$label[[5]]
matdata1$label[[6]]
matdata1$label[[7]]
matdata1$label[[8]]
matdata1$label[[9]]
matdata1$label[[10]]
matdata1$label[[11]]
matdata1$label[[12]]
matdata1$label[[13]]
matdata1$label[[14]]
matdata1$label[[15]]
matdata1$label[[15]]
matdata1$label[[16]]
matdata1$label[[17]]
matdata1$label[[18]]
matdata1$label[[19]]
matdata1$label[[20]]
matdata1$label[[21]]
matdata1$label[[22]]
matdata1$label[[23]]
matdata1$label[[24]]
matdata1$label[[25]]
matdata1$label[[26]]
matdata1$label[[27]]
matdata1$label[[28]]
matdata1$label[[29]]
matdata1$label[[30]]
matdata1$class[[1]]
library(R.matlab)
library(tidyverse)
path <- 'C:\\Users\\tuhu\\projects\\barley\\datamatchNEG.mat'
matdata <- readMat(path)
matdata1 <- matdata[[1]] #[1] and [[1]] are different
#subject info
##extract filename
filename1 <- matdata1$label[[1]]
filename <- filename1[[1]]
##extract samplename
meal1 <- matdata1$label[[5]]
meal <- meal1[[1]]
##extract protein source
protein_source1 <- matdata1$label[[9]]
protein_source <- protein_source1[[1]]
##extract gender info
gender1 <- matdata1$label[[13]]
gender <- gender1[[1]]
##extract time point
timepoint1 <- matdata1$class[[1]]
timepoint <- t(timepoint1[[1]])
##extract mz
mz1 <- matdata1$label[[6]]
mz <- mz1[[1]]
##extract rt
rt1 <- matdata1$label[[10]]
rt <- rt1[[1]]
##extract person
person1 <- matdata1$label[[21]]
person <- person1[[1]]
##extract intensities
int <- matdata1$data
##shape new data
data <- data.frame(filename,meal,protein_source,timepoint,person)
#  pools <- data %>% filter(samplename =='pool  ')
#  nonpools <- data %>% filter(samplename != 'pool  ')
#  pools$subject <- 'pool'
#  pools$timepoint <- NA
#  pools$intervention <- 'pool'
#  data <- bind_rows(nonpools,pools)
intdata <- data.frame(int)
datan <- bind_cols(data,intdata)
datan1 <- datan %>% gather(feature,intensity,6:ncol(datan))
##write rt and mz
rtdata <- t(rt) %>% data.frame() %>% gather(feature, rt, 1: nrow(rt))
mzdata <- t(mz) %>% data.frame() %>% gather(feature, mz, 1: nrow(mz))
datan2 <- left_join(datan1,rtdata,by='feature') %>% left_join(mzdata,by='feature')
datan3 <- datan2 %>% filter(meal==c('Barley','Pie   ','Soup  '))
View(datan3)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
#geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
excretionplot('X37')
excretionplot(Features)
features <- paste0('X',1:39)
excretionplot(Features)
excretionplot(features)
lapply(features,excretionplot)
excretionplotofprotein <- function (featurex){
datan3 %>% group_by(feature,timepoint,protein_source) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=protein_source,color=protein_source)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
excretionplot <- function (featurex){
datan3 %>% group_by(feature,timepoint,meal) %>%
summarize(intmean=mean(intensity),intsd=sd(intensity)) %>%
mutate(intmean,intsd) %>% filter(feature==featurex & timepoint!=24) %>%
ggplot(aes(x=timepoint,y=intmean,group=meal,color=meal)) +
geom_line() +
geom_errorbar(aes(ymin=intmean-intsd,ymax=intmean+intsd)) +
ggtitle(featurex)
}
excretionplot('X33')
matdata <- readMat(path)
summary(matdata1)
matdata1$axisscale
matdata1$class
matdata1$class[1]
matdata1$class[2]
matdata1$class[3]
matdata1$class[4]
matdata1$class[5]
matdata1$class[8]
matdata1$class[6]
matdata1$class[7]
